#!/usr/bin/env bash
# Configures host resolution: localhost → 127.0.0.2, facebook.com → 8.8.8.8

# Temporary file to write updates
tmpfile=$(mktemp)

# Change localhost mapping
sed 's/^127\.0\.0\.1[[:space:]]\+localhost/127.0.0.2 localhost/' /etc/hosts > "$tmpfile"

# facebook.com mapping (replace if exists, otherwise append)
if grep -q "facebook.com" "$tmpfile"; then
    sed 's/.*facebook.com/8.8.8.8 facebook.com/' "$tmpfile" > "${tmpfile}.2"
    mv "${tmpfile}.2" "$tmpfile"
else
    echo "8.8.8.8 facebook.com" >> "$tmpfile"
fi

# Overwrite hosts file
cat "$tmpfile" > /etc/hosts

# Clean up
rm -f "$tmpfile"
